# Лабораторная работа №3
## Часть 1
![1](https://github.com/user-attachments/assets/d37ca6e9-89ff-477f-8919-5fc9bdcda43a)

![2](https://github.com/user-attachments/assets/fb1a7496-0024-42a0-a321-975c16c86d82)

![3](https://github.com/user-attachments/assets/9304d109-6631-4cd2-bbfe-6e5c40b7770b)

## Часть 2
![21](https://github.com/user-attachments/assets/f0baefd7-877b-448b-a9c5-9cd76e7542d1)

![22](https://github.com/user-attachments/assets/aa10d9cd-deef-4883-b1d3-215cb3a5893b)

![23](https://github.com/user-attachments/assets/8aeecbbe-9e67-467b-ba5c-49512670e8bf)

![24](https://github.com/user-attachments/assets/b83b3325-8a1f-407f-8ca4-28976f58e398)

## Часть 3
![31](https://github.com/user-attachments/assets/91fda370-1ea9-4e5e-8198-2a59fe16c3df)

![32](https://github.com/user-attachments/assets/c4305f6e-326d-449e-b7d7-d7ea10192769)


## Задание 
### Описание
Любым способом выключаем доступ до ноды, которая сейчас является мастером (например, через docker stop). Некоторое время ждем, после этого анализируем логи и так же пытаемся считать/записать что-то в БД через entrypoint подключение. Затем необходимо расписать, получилось или нет, а так же объяснить, что в итоге произошло после принудительного выключения мастера (со скриншотами)
###Выполнение
![41](https://github.com/user-attachments/assets/999a8d52-7b33-47a6-8a85-b4d622814803)

![42](https://github.com/user-attachments/assets/27fc5be4-ce58-450a-b335-0228ef9a2fea)

![43](https://github.com/user-attachments/assets/4a629462-872f-4c62-a58d-58dc979749f5)


## Ответы на вопросы
1. Порты 8008 и 5432 вынесены в разные директивы, expose и ports. По сути, если записать 8008 в ports, то он тоже станет exposed. В чем разница?

Директива expose используется, если контейнеры взаимодействуют только внутри сети Docker и нет необходимости открывать порт для внешнего окружения. Директива ports применяется, чтобы внешние клиенты могли подключаться. Указание порта в ports включает функциональность expose. То есть порт 8008 становится доступным для других контейнеров в сети Docker, и дополнительно маппится на хост, делая его доступным извне.

2. При обычном перезапуске композ-проекта, будет ли сбилден заново образ? А если предварительно отредактировать файлы postgresX.yml? А если содержимое самого Dockerfile? Почему?

Образ не будет сбилден заново. При перезапуске docker compose используются уже существующие образы, если они были ранее созданы. docker compose проверяет наличие соответствующего образа в локальном кэше и запускает контейнеры с ним.
Если отредактировать файлы postgresX.yml и перезапустить проект, изменения вступят в силу. Эти файлы передаются в контейнер как конфигурация Patroni, который при запуске считывает содержимое этих файлов, поэтому любые изменения будут сразу применены.
Если содержимое Dockerfile изменилось, образы не будут пересобраны автоматически при перезапуске. docker compose не отслеживает изменения в dockerfile. Он использует уже существующий образ, если он был создан ранее. Чтобы изменения в dockerfile применились, необходимо вручную пересобрать образ.
